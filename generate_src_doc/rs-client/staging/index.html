
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../example/">
      
      
        <link rel="next" href="../s1_l0/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Staging - RS-Python</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../_templates/sidebar_width.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
  <style>
    .custom-logo-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 10px;
      transition: all 0.1s ease-in-out;
    }

    .customBottom-logo-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
      width: 100%;
      max-width: 600px;
      transition: all 0.1s ease-in-out;
    }

    .custom-logo-container img,
    .customBottom-logo-container img {
      width: auto;
      height: 50px;
      transition: all 0.1s ease-in-out;
    }

    .customTop-logo-container > div {
        margin-top: 10px;
    }

  </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Move logo containers
      var topLogoContainer = document.querySelector('.customTop-logo-container');
      var bottomLogoContainer = document.querySelector('.customBottom-logo-container');
      var sidebarPrimary = document.querySelector('.md-sidebar--primary');
      var sidebarScrollwrap = document.querySelector('.md-sidebar__scrollwrap');

      if (topLogoContainer && sidebarPrimary) {
        sidebarPrimary.insertBefore(topLogoContainer, sidebarPrimary.firstChild);
      }

      if (bottomLogoContainer && sidebarScrollwrap) {
        sidebarScrollwrap.insertAdjacentElement('afterend', bottomLogoContainer);
      }

      // Theme detection and image switch
      function switchImagesBasedOnTheme() {
        var isDarkTheme = document.querySelectorAll('body[data-md-color-scheme="slate"]').length > 0;
        var images = document.querySelectorAll('img[data-dark-src]');

        images.forEach(function(img) {
          if (isDarkTheme) {
            img.src = img.getAttribute('data-dark-src');
          } else {
            img.src = img.getAttribute('data-light-src');
          }
        });
      }

      // Initial switch
      switchImagesBasedOnTheme();

      // Listen for theme change events
      $(".md-option").on("click", function (evt) {
        setTimeout(switchImagesBasedOnTheme, 100); // Delay to allow theme change to apply
      });
      /*
      var themeToggleButton = document.getElementsByClassName("md-option");
      if (themeToggleButton) {
        themeToggleButton.addEventListener('click', function() {
          setTimeout(switchImagesBasedOnTheme, 100); // Delay to allow theme change to apply
        });
      }
      */
      // If the theme change is triggered by other means
      document.documentElement.addEventListener('theme-changed', switchImagesBasedOnTheme);
    });
  </script>


  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rs_workflows.staging" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
  
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="RS-Python" class="md-header__button md-logo" aria-label="RS-Python" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RS-Python
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Staging
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../rs-server/docs/doc/" class="md-tabs__link">
          
  
    
  
  RS-Server

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../rs-client-libraries/docs/doc/" class="md-tabs__link">
          
  
    
  
  RS-Client

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../rs-demo/doc/" class="md-tabs__link">
          
  
    
  
  RS-Notebooks

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../rs_deployment_start/" class="md-tabs__link">
          
  
    
  
  RS-Deployment

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
  <div class="customTop-logo-container custom-logo-container">
    <div class="customEU-logo">
      <a href="https://www.airbus.com/en" target="_blank">
        <img src="../../../_static/EC_POS.png"
             alt="EU Logo"
             data-light-src="../../../_static/EC_POS.png"
             data-dark-src="../../../_static/EC_NEG.png" />
      </a>
    </div>
    <div class="customCop-logo">
      <a href="https://www.csgroup.eu/en/" target="_blank">
        <img src="../../../_static/Copernicus_blue.png"
             alt="Copernicus Logo"
             data-light-src="../../../_static/Copernicus_blue.png"
             data-dark-src="../../../_static/Copernicus_white.png" />
      </a>
    </div>
    <div class="customESA-logo">
      <a href="https://www.csgroup.eu/en/" target="_blank">
        <img src="../../../_static/ESA_logo_2020_Deep.png"
             alt="ESA Logo"
             data-light-src="../../../_static/ESA_logo_2020_Deep.png"
             data-dark-src="../../../_static/ESA_logo_2020_White.png" />
      </a>
    </div>
  </div>

  <div class="customBottom-logo-container">
    <div class="customAirbus-logo">
      <a href="https://www.airbus.com/en" target="_blank">
        <img src="../../../_static/AIRBUS_Blue.png"
             alt="Airbus Logo"
             data-light-src="../../../_static/AIRBUS_Blue.png"
             data-dark-src="../../../_static/AIRBUS_White.png" />
      </a>
    </div>
    <div class="customCS-logo">
      <a href="https://www.csgroup.eu/en/" target="_blank">
        <img src="../../../_static/logo_cs_group_bleu_petit.png"
             alt="CS Group Logo"
             data-light-src="../../../_static/logo_cs_group_bleu_petit.png"
             data-dark-src="../../../_static/logo_cs_group_bleu_petit.png" />
      </a>
    </div>
  </div>

    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="RS-Python" class="md-nav__button md-logo" aria-label="RS-Python" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    RS-Python
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Home
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../how_to/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Documentation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../rs-server/docs/doc/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    RS-Server
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            RS-Server
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Manual
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            User Manual
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-server/docs/doc/user_manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Description
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-server/docs/doc/users/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overal Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-server/docs/doc/users/functionalities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Main Functionalities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-server/docs/doc/users/oauth2_apikey_manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OAuth2 and API Key Manager
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer Manual
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Developer Manual
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-server/docs/doc/developer_manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Description
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-server/docs/doc/dev/environment/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-server/docs/doc/dev/code-style/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code style
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_4" >
        
          
          <label class="md-nav__link" for="__nav_2_3_4" id="__nav_2_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Rest
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            API Rest
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rs-server/swagger_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SwaggerUI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../rs-server/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Python API Library
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3_5" id="__nav_2_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_5">
            <span class="md-nav__icon md-icon"></span>
            Python API Library
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rs-server/adgs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ADGS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rs-server/cadip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CADIP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-server/docs/doc/users/catalog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Catalog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rs-server/common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rs-server/frontend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frontend
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_6" >
        
          
          <label class="md-nav__link" for="__nav_2_3_6" id="__nav_2_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Additional information
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_6">
            <span class="md-nav__icon md-icon"></span>
            Additional information
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-server/docs/doc/dev/background/tree-structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tree structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-server/docs/doc/dev/background/workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-server/docs/doc/dev/background/ci/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../rs-client-libraries/docs/doc/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    RS-Client
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            RS-Client
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Python API Library
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Python API Library
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rs_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RS-Client Classes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    RS-Client Workflows
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            RS-Client Workflows
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Staging
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Staging
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rs_workflows.staging" class="md-nav__link">
    <span class="md-ellipsis">
      staging
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rs_workflows.staging.PrefectCommonConfig" class="md-nav__link">
    <span class="md-ellipsis">
      PrefectCommonConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rs_workflows.staging.PrefectFlowConfig" class="md-nav__link">
    <span class="md-ellipsis">
      PrefectFlowConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PrefectFlowConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rs_workflows.staging.PrefectFlowConfig.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rs_workflows.staging.PrefectTaskConfig" class="md-nav__link">
    <span class="md-ellipsis">
      PrefectTaskConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PrefectTaskConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rs_workflows.staging.PrefectTaskConfig.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rs_workflows.staging.create_collection_name" class="md-nav__link">
    <span class="md-ellipsis">
      create_collection_name
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rs_workflows.staging.filter_unpublished_files" class="md-nav__link">
    <span class="md-ellipsis">
      filter_unpublished_files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rs_workflows.staging.get_prefect_logger" class="md-nav__link">
    <span class="md-ellipsis">
      get_prefect_logger
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rs_workflows.staging.staging" class="md-nav__link">
    <span class="md-ellipsis">
      staging
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rs_workflows.staging.staging_flow" class="md-nav__link">
    <span class="md-ellipsis">
      staging_flow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rs_workflows.staging.update_stac_catalog" class="md-nav__link">
    <span class="md-ellipsis">
      update_stac_catalog
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../s1_l0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    S1 L0
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rs_client_common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RS-Client Common
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../rs-demo/doc/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    RS-Notebooks
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            RS-Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-demo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running Modes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    RS-Deployment
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            RS-Deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs_deployment_start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../rs-infrastructure/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Infrastructure Deployment
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Infrastructure Deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-infrastructure/docs/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-infrastructure/docs/how-to/Cluster%20Management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-infrastructure/docs/how-to/Cluster%20start%20and%20stop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster start and stop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-infrastructure/docs/how-to/GitHub%20Container%20Registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub container registry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-infrastructure/docs/how-to/Ingress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ingress controller
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-infrastructure/docs/how-to/Prefect-Worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prefect worker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-infrastructure/docs/how-to/Remote%20kubectl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remote kubectl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rs-infrastructure/docs/how-to/Wazuh-Server_Install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wazuh Server installation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../rs-helm/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Applications Deployment
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Applications Deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Staging</h1>

<div class="doc doc-object doc-module">



<a id="rs_workflows.staging"></a>
    <div class="doc doc-contents first">

      <p>Common workflows for general usage</p>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="rs_workflows.staging.PrefectCommonConfig" class="doc doc-heading">
            <code>PrefectCommonConfig</code>


</h2>


    <div class="doc doc-contents ">


      <p>Common configuration for Prefect tasks and flows.
Base class for configuration used in Prefect task and flow
used in staging the files from different stations (cadip, adgs...)</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="rs_workflows.staging.PrefectCommonConfig.rs_client">rs_client</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="rs_client.auxip_client.AuxipClient" href="../rs_client/#rs_client.auxip_client.AuxipClient">AuxipClient</a> | <a class="autorefs autorefs-internal" title="rs_client.cadip_client.CadipClient" href="../rs_client/#rs_client.cadip_client.CadipClient">CadipClient</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The client for accessing the Auxip or Cadip service.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rs_workflows.staging.PrefectCommonConfig.mission">mission</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mission identifier.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rs_workflows.staging.PrefectCommonConfig.tmp_download_path">tmp_download_path</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The local path where temporary files will be downloaded.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rs_workflows.staging.PrefectCommonConfig.s3_path">s3_path</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 bucket path where the files will be stored.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>docs/rs-client-libraries/rs_workflows/staging.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PrefectCommonConfig</span><span class="p">:</span>  <span class="c1"># pylint: disable=too-few-public-methods, too-many-instance-attributes,</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Common configuration for Prefect tasks and flows.</span>
<span class="sd">    Base class for configuration used in Prefect task and flow</span>
<span class="sd">    used in staging the files from different stations (cadip, adgs...)</span>

<span class="sd">    Attributes:</span>
<span class="sd">        rs_client (AuxipClient | CadipClient): The client for accessing the Auxip or Cadip service.</span>
<span class="sd">        mission (str): The mission identifier.</span>
<span class="sd">        tmp_download_path (str): The local path where temporary files will be downloaded.</span>
<span class="sd">        s3_path (str): The S3 bucket path where the files will be stored.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rs_client</span><span class="p">:</span> <span class="n">AuxipClient</span> <span class="o">|</span> <span class="n">CadipClient</span><span class="p">,</span>
        <span class="n">mission</span><span class="p">,</span>
        <span class="n">tmp_download_path</span><span class="p">,</span>
        <span class="n">s3_path</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rs_client</span><span class="p">:</span> <span class="n">AuxipClient</span> <span class="o">|</span> <span class="n">CadipClient</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># don&#39;t save this instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rs_client_serialization</span> <span class="o">=</span> <span class="n">RsClientSerialization</span><span class="p">(</span><span class="n">rs_client</span><span class="p">)</span>  <span class="c1"># save the serialization parameters instead</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mission</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">mission</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmp_download_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">tmp_download_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">s3_path</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="rs_workflows.staging.PrefectFlowConfig" class="doc doc-heading">
            <code>PrefectFlowConfig</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="rs_workflows.staging.PrefectCommonConfig" href="#rs_workflows.staging.PrefectCommonConfig">PrefectCommonConfig</a></code></p>


      <p>Configuration class for Prefect flow.</p>
<p>This class inherits the PrefectCommonConfig and represents the configuration for a
Prefect flow</p>


<p><span class="doc-section-title">see :py:class:`PrefectCommonConfig`</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="rs_workflows.staging.PrefectFlowConfig.max_workers">max_workers</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of workers for the Prefect flow.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rs_workflows.staging.PrefectFlowConfig.start_datetime">start_datetime</span></code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The start datetime of the files that the station should return</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rs_workflows.staging.PrefectFlowConfig.stop_datetime">stop_datetime</span></code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The stop datetime of the files that the station should return</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rs_workflows.staging.PrefectFlowConfig.limit">limit</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The limit for the number of the files in the list retrieved from the ADGS/CADIP station (optional).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>docs/rs-client-libraries/rs_workflows/staging.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PrefectFlowConfig</span><span class="p">(</span><span class="n">PrefectCommonConfig</span><span class="p">):</span>  <span class="c1"># pylint: disable=too-few-public-methods</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration class for Prefect flow.</span>

<span class="sd">    This class inherits the PrefectCommonConfig and represents the configuration for a</span>
<span class="sd">    Prefect flow</span>

<span class="sd">    Attributes: see :py:class:`PrefectCommonConfig`</span>
<span class="sd">        max_workers (int): The maximum number of workers for the Prefect flow.</span>
<span class="sd">        start_datetime (datetime): The start datetime of the files that the station should return</span>
<span class="sd">        stop_datetime (datetime): The stop datetime of the files that the station should return</span>
<span class="sd">        limit: The limit for the number of the files in the list retrieved from the ADGS/CADIP station (optional).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>  <span class="c1"># pylint: disable=too-many-arguments</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rs_client</span><span class="p">:</span> <span class="n">AuxipClient</span> <span class="o">|</span> <span class="n">CadipClient</span><span class="p">,</span>
        <span class="n">mission</span><span class="p">,</span>
        <span class="n">tmp_download_path</span><span class="p">,</span>
        <span class="n">s3_path</span><span class="p">,</span>
        <span class="n">max_workers</span><span class="p">,</span>
        <span class="n">start_datetime</span><span class="p">,</span>
        <span class="n">stop_datetime</span><span class="p">,</span>
        <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the PrefectFlowConfig object with provided parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">rs_client</span><span class="p">,</span> <span class="n">mission</span><span class="p">,</span> <span class="n">tmp_download_path</span><span class="p">,</span> <span class="n">s3_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">max_workers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">start_datetime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">stop_datetime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="n">limit</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rs_workflows.staging.PrefectFlowConfig.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">rs_client</span><span class="p">,</span> <span class="n">mission</span><span class="p">,</span> <span class="n">tmp_download_path</span><span class="p">,</span> <span class="n">s3_path</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">,</span> <span class="n">start_datetime</span><span class="p">,</span> <span class="n">stop_datetime</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Initialize the PrefectFlowConfig object with provided parameters.</p>

            <details class="quote">
              <summary>Source code in <code>docs/rs-client-libraries/rs_workflows/staging.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>  <span class="c1"># pylint: disable=too-many-arguments</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">rs_client</span><span class="p">:</span> <span class="n">AuxipClient</span> <span class="o">|</span> <span class="n">CadipClient</span><span class="p">,</span>
    <span class="n">mission</span><span class="p">,</span>
    <span class="n">tmp_download_path</span><span class="p">,</span>
    <span class="n">s3_path</span><span class="p">,</span>
    <span class="n">max_workers</span><span class="p">,</span>
    <span class="n">start_datetime</span><span class="p">,</span>
    <span class="n">stop_datetime</span><span class="p">,</span>
    <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the PrefectFlowConfig object with provided parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">rs_client</span><span class="p">,</span> <span class="n">mission</span><span class="p">,</span> <span class="n">tmp_download_path</span><span class="p">,</span> <span class="n">s3_path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">max_workers</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">start_datetime</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">stop_datetime</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">limit</span> <span class="o">=</span> <span class="n">limit</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="rs_workflows.staging.PrefectTaskConfig" class="doc doc-heading">
            <code>PrefectTaskConfig</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="rs_workflows.staging.PrefectCommonConfig" href="#rs_workflows.staging.PrefectCommonConfig">PrefectCommonConfig</a></code></p>


      <p>Configuration class for Prefect tasks.</p>
<p>This class extends the <code>PrefectCommonConfig</code> class with additional attributes
specific to Prefect tasks. It includes the configuration for the task, such as the
files to be processed by the task and the maximum number of retries allowed.</p>


<p><span class="doc-section-title">see :py:class:`PrefectCommonConfig`</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="rs_workflows.staging.PrefectTaskConfig.task_files_stac">task_files_stac</span></code></td>
            <td>
                  <code>List[Dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries containing information about the files to be processed
                          by the task. This info is in STAC format</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rs_workflows.staging.PrefectTaskConfig.max_retries">max_retries</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of retries allowed for the task.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>docs/rs-client-libraries/rs_workflows/staging.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PrefectTaskConfig</span><span class="p">(</span><span class="n">PrefectCommonConfig</span><span class="p">):</span>  <span class="c1"># pylint: disable=too-few-public-methods</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration class for Prefect tasks.</span>

<span class="sd">    This class extends the `PrefectCommonConfig` class with additional attributes</span>
<span class="sd">    specific to Prefect tasks. It includes the configuration for the task, such as the</span>
<span class="sd">    files to be processed by the task and the maximum number of retries allowed.</span>

<span class="sd">    Attributes: see :py:class:`PrefectCommonConfig`</span>
<span class="sd">        task_files_stac (List[Dict]): A list of dictionaries containing information about the files to be processed</span>
<span class="sd">                                      by the task. This info is in STAC format</span>
<span class="sd">        max_retries (int): The maximum number of retries allowed for the task.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>  <span class="c1"># pylint: disable=too-many-arguments</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rs_client</span><span class="p">:</span> <span class="n">AuxipClient</span> <span class="o">|</span> <span class="n">CadipClient</span><span class="p">,</span>
        <span class="n">mission</span><span class="p">,</span>
        <span class="n">tmp_download_path</span><span class="p">,</span>
        <span class="n">s3_path</span><span class="p">,</span>
        <span class="n">task_files_stac</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the PrefectTaskConfig object with provided parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">rs_client</span><span class="p">,</span> <span class="n">mission</span><span class="p">,</span> <span class="n">tmp_download_path</span><span class="p">,</span> <span class="n">s3_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_files_stac</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="n">task_files_stac</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">max_retries</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rs_workflows.staging.PrefectTaskConfig.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">rs_client</span><span class="p">,</span> <span class="n">mission</span><span class="p">,</span> <span class="n">tmp_download_path</span><span class="p">,</span> <span class="n">s3_path</span><span class="p">,</span> <span class="n">task_files_stac</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Initialize the PrefectTaskConfig object with provided parameters.</p>

            <details class="quote">
              <summary>Source code in <code>docs/rs-client-libraries/rs_workflows/staging.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>  <span class="c1"># pylint: disable=too-many-arguments</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">rs_client</span><span class="p">:</span> <span class="n">AuxipClient</span> <span class="o">|</span> <span class="n">CadipClient</span><span class="p">,</span>
    <span class="n">mission</span><span class="p">,</span>
    <span class="n">tmp_download_path</span><span class="p">,</span>
    <span class="n">s3_path</span><span class="p">,</span>
    <span class="n">task_files_stac</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the PrefectTaskConfig object with provided parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">rs_client</span><span class="p">,</span> <span class="n">mission</span><span class="p">,</span> <span class="n">tmp_download_path</span><span class="p">,</span> <span class="n">s3_path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">task_files_stac</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="n">task_files_stac</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">max_retries</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="rs_workflows.staging.create_collection_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_collection_name</span><span class="p">(</span><span class="n">mission</span><span class="p">,</span> <span class="n">station</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Create the name of a catalog collection</p>
<p>This function constructs and returns a specific name for the catalog collection.
For ADGS station type should be "mission_name"_aux
For CADIP stations types should be "mission_name"_chunk</p>
<p>For other values, a RuntimeError is raised.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>mission</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the mission.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>station</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of station . Supported
values are "AUX" and "CADIP", "INS", "MPS", "MTI", "NSG", "SGS".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the collection</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>RuntimeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the provided station type is not supported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>docs/rs-client-libraries/rs_workflows/staging.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_collection_name</span><span class="p">(</span><span class="n">mission</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">station</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the name of a catalog collection</span>

<span class="sd">    This function constructs and returns a specific name for the catalog collection.</span>
<span class="sd">    For ADGS station type should be &quot;mission_name&quot;_aux</span>
<span class="sd">    For CADIP stations types should be &quot;mission_name&quot;_chunk</span>

<span class="sd">    For other values, a RuntimeError is raised.</span>

<span class="sd">    Args:</span>
<span class="sd">        mission (str): The name of the mission.</span>
<span class="sd">        station (str): The type of station . Supported</span>
<span class="sd">            values are &quot;AUX&quot; and &quot;CADIP&quot;, &quot;INS&quot;, &quot;MPS&quot;, &quot;MTI&quot;, &quot;NSG&quot;, &quot;SGS&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str (str): The name of the collection</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the provided station type is not supported.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">station</span> <span class="o">==</span> <span class="n">AUXIP_STATION</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mission</span><span class="si">}</span><span class="s2">_aux&quot;</span>
    <span class="c1"># check CADIP</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ECadipStation</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mission</span><span class="si">}</span><span class="s2">_chunk&quot;</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown station: </span><span class="si">{</span><span class="n">station</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rs_workflows.staging.filter_unpublished_files" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_unpublished_files</span><span class="p">(</span><span class="n">stac_client</span><span class="p">,</span> <span class="n">collection_name</span><span class="p">,</span> <span class="n">files_stac</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Checks for unpublished files in the STAC catalog.</p>
<p>This function takes a list of files and checks if they are already published in a specified
STAC (SpatioTemporal Asset Catalog) collection. It returns a list of files that are not yet published.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>stac_client</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="rs_client.stac_client.StacClient" href="../rs_client/#rs_client.stac_client.StacClient">StacClient</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of <code>StacClient</code> to interact with the STAC catalog.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>collection_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the collection in which the search is performed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>files_stac</code></td>
            <td>
                  <code>list of dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of files to be checked for publication. Each file is represented as a
dictionary with at least an "id" key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of dict: A list of files that are not yet published in the catalog. Each file is represented as a</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">rs_client</span> <span class="o">=</span> <span class="n">StacClient</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;example_collection&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">files_stac</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;file1.raw&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;file2.raw&quot;</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unpublished_files</span> <span class="o">=</span> <span class="n">filter_unpublished_files</span><span class="p">(</span><span class="n">rs_client</span><span class="p">,</span> <span class="n">collection_name</span><span class="p">,</span> <span class="n">files_stac</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">unpublished_files</span><span class="p">)</span>
<span class="go">[{&quot;id&quot;: &quot;file1.raw&quot;}]</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>docs/rs-client-libraries/rs_workflows/staging.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">filter_unpublished_files</span><span class="p">(</span>
    <span class="n">stac_client</span><span class="p">:</span> <span class="n">StacClient</span><span class="p">,</span>  <span class="c1"># NOTE: maybe use RsClientSerialization instead</span>
    <span class="n">collection_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">files_stac</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks for unpublished files in the STAC catalog.</span>

<span class="sd">    This function takes a list of files and checks if they are already published in a specified</span>
<span class="sd">    STAC (SpatioTemporal Asset Catalog) collection. It returns a list of files that are not yet published.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        stac_client (StacClient): An instance of `StacClient` to interact with the STAC catalog.</span>
<span class="sd">        collection_name (str): The name of the collection in which the search is performed.</span>
<span class="sd">        files_stac (list of dict): A list of files to be checked for publication. Each file is represented as a</span>
<span class="sd">            dictionary with at least an &quot;id&quot; key.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of dict: A list of files that are not yet published in the catalog. Each file is represented as a</span>
<span class="sd">        dictionary.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; rs_client = StacClient(...)</span>
<span class="sd">        &gt;&gt;&gt; collection_name = &quot;example_collection&quot;</span>
<span class="sd">        &gt;&gt;&gt; files_stac = [{&quot;id&quot;: &quot;file1.raw&quot;}, {&quot;id&quot;: &quot;file2.raw&quot;}]</span>
<span class="sd">        &gt;&gt;&gt; unpublished_files = filter_unpublished_files(rs_client, collection_name, files_stac)</span>
<span class="sd">        &gt;&gt;&gt; print(unpublished_files)</span>
<span class="sd">        [{&quot;id&quot;: &quot;file1.raw&quot;}]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get files IDs (no duplicate IDs)</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">fs</span> <span class="ow">in</span> <span class="n">files_stac</span><span class="p">:</span>
        <span class="n">ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fs</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]))</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>  <span class="c1"># type: ignore # set to list conversion</span>

    <span class="c1"># For searching, we need to prefix our collection name by &lt;owner_id&gt;_</span>
    <span class="n">owner_collection</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stac_client</span><span class="o">.</span><span class="n">owner_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">collection_name</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Search using a CQL2 filter, see: https://pystac-client.readthedocs.io/en/stable/tutorials/cql2-filter.html</span>
    <span class="n">filter_</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="s2">&quot;and&quot;</span><span class="p">,</span>
        <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;property&quot;</span><span class="p">:</span> <span class="s2">&quot;collection&quot;</span><span class="p">},</span> <span class="n">owner_collection</span><span class="p">]},</span>
            <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;property&quot;</span><span class="p">:</span> <span class="s2">&quot;owner&quot;</span><span class="p">},</span> <span class="n">stac_client</span><span class="o">.</span><span class="n">owner_id</span><span class="p">]},</span>
            <span class="p">{</span><span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="s2">&quot;in&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;property&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span><span class="p">},</span> <span class="n">ids</span><span class="p">]},</span>
        <span class="p">],</span>
    <span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">search</span> <span class="o">=</span> <span class="n">stac_client</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="nb">filter</span><span class="o">=</span><span class="n">filter_</span><span class="p">)</span>
        <span class="n">existing</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">items_as_dicts</span><span class="p">())</span>

    <span class="c1"># In case of any error, try to ingest everything anyway</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">stac_client</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Search exception caught: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">files_stac</span>

    <span class="c1"># Only keep the files that do not alreay exist in the catalog</span>
    <span class="n">existing_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">existing</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">file_stac</span> <span class="k">for</span> <span class="n">file_stac</span> <span class="ow">in</span> <span class="n">files_stac</span> <span class="k">if</span> <span class="n">file_stac</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_ids</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rs_workflows.staging.get_prefect_logger" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_prefect_logger</span><span class="p">(</span><span class="n">general_logger_name</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>It returns the Prefect logger. If this can't be taken due to the missing
Prefect context (i.e. the flow/task is executed as a single function, from Pytest for example),
the general logger is returned</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>general_logger_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the general logger if Prefect logger can't be returned.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>logger</code></td>            <td>
                  <code>logger</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Prefect logger instance or a general logger instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>docs/rs-client-libraries/rs_workflows/staging.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_prefect_logger</span><span class="p">(</span><span class="n">general_logger_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It returns the Prefect logger. If this can&#39;t be taken due to the missing</span>
<span class="sd">    Prefect context (i.e. the flow/task is executed as a single function, from Pytest for example),</span>
<span class="sd">    the general logger is returned</span>

<span class="sd">    Args:</span>
<span class="sd">        general_logger_name (str): The name of the general logger if Prefect logger can&#39;t be returned.</span>

<span class="sd">    Returns:</span>
<span class="sd">        logger (logger): A Prefect logger instance or a general logger instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">SET_PREFECT_LOGGING_LEVEL</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">MissingContextError</span><span class="p">:</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">Logging</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">general_logger_name</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Could not get the prefect logger due to missing context. Using the general one&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">logger</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rs_workflows.staging.staging" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">staging</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Prefect task function to stage (=download/ingest) files from a specified station.</p>
<p>This task function stages files for processing by calling the appropriate
rs-server endpoint for each requested file. It monitors the status of the file until it is
completely staged before initiating the next stage request.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="rs_workflows.staging.PrefectTaskConfig" href="#rs_workflows.staging.PrefectTaskConfig">PrefectTaskConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configuration object containing the necessary parameters
                        for staging the files.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>List</code></td>            <td>
                  <code>[dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list containing information about files that FAILED to be staged. The files within this
        list don't appear in the catalog as published</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>docs/rs-client-libraries/rs_workflows/staging.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">staging</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">PrefectTaskConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prefect task function to stage (=download/ingest) files from a specified station.</span>

<span class="sd">    This task function stages files for processing by calling the appropriate</span>
<span class="sd">    rs-server endpoint for each requested file. It monitors the status of the file until it is</span>
<span class="sd">    completely staged before initiating the next stage request.</span>

<span class="sd">    Args:</span>
<span class="sd">        config (PrefectTaskConfig): The configuration object containing the necessary parameters</span>
<span class="sd">                                    for staging the files.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List ([dict]): A list containing information about files that FAILED to be staged. The files within this</span>
<span class="sd">                    list don&#39;t appear in the catalog as published</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_prefect_logger</span><span class="p">(</span><span class="s2">&quot;task_dwn&quot;</span><span class="p">)</span>

    <span class="c1"># Deserialize the RsClient instance</span>
    <span class="n">rs_client</span><span class="p">:</span> <span class="n">AuxipClient</span> <span class="o">|</span> <span class="n">CadipClient</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">rs_client_serialization</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="c1"># list with failed files</span>
    <span class="n">failed_files</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">task_files_stac</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">downloaded_files_indices</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Call the download endpoint for each requested file</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_stac</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">task_files_stac</span><span class="p">):</span>
        <span class="c1"># update the filename to be ingested</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rs_client</span><span class="o">.</span><span class="n">staging</span><span class="p">(</span><span class="n">file_stac</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">config</span><span class="o">.</span><span class="n">s3_path</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">tmp_download_path</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">ENDPOINT_TIMEOUT</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># TODO: Continue? Stop ?</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not stage file %s. Exception: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="c1"># monitor the status of the file until it is completely downloaded before initiating the next download request</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">rs_client</span><span class="o">.</span><span class="n">staging_status</span><span class="p">(</span><span class="n">file_stac</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">ENDPOINT_TIMEOUT</span><span class="p">)</span>
        <span class="c1"># just for the demo the timeout is hardcoded, it should be otherwise defined somewhere in the configuration</span>
        <span class="n">timeout</span> <span class="o">=</span> <span class="n">DOWNLOAD_FILE_TIMEOUT</span>  <span class="c1"># 6 minutes</span>
        <span class="k">while</span> <span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="n">EDownloadStatus</span><span class="o">.</span><span class="n">NOT_STARTED</span><span class="p">,</span> <span class="n">EDownloadStatus</span><span class="o">.</span><span class="n">IN_PROGRESS</span><span class="p">]</span> <span class="ow">and</span> <span class="n">timeout</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;The download progress for file </span><span class="si">%s</span><span class="s2"> is </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">file_stac</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
                <span class="n">status</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">timeout</span> <span class="o">-=</span> <span class="mi">2</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">rs_client</span><span class="o">.</span><span class="n">staging_status</span><span class="p">(</span><span class="n">file_stac</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="n">ENDPOINT_TIMEOUT</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">EDownloadStatus</span><span class="o">.</span><span class="n">DONE</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;File </span><span class="si">%s</span><span class="s2"> has been properly downloaded...&quot;</span><span class="p">,</span> <span class="n">file_stac</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
            <span class="c1"># TODO: either move the code from filter_unpublished_files to RsClient</span>
            <span class="c1"># or use the new PgstacClient ?</span>
            <span class="k">if</span> <span class="n">update_stac_catalog</span><span class="o">.</span><span class="n">fn</span><span class="p">(</span>
                <span class="n">rs_client</span><span class="o">.</span><span class="n">get_stac_client</span><span class="p">(),</span>  <span class="c1"># NOTE: maybe use RsClientSerialization instead</span>
                <span class="n">create_collection_name</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">mission</span><span class="p">,</span> <span class="n">rs_client</span><span class="o">.</span><span class="n">station_name</span><span class="p">),</span>
                <span class="n">file_stac</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">s3_path</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File well published: </span><span class="si">{</span><span class="n">file_stac</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="c1"># save the index of the well ingested file</span>
                <span class="n">downloaded_files_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not publish file: </span><span class="si">{</span><span class="n">file_stac</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Error in downloading the file </span><span class="si">%s</span><span class="s2"> (status </span><span class="si">%s</span><span class="s2">). Timeout was </span><span class="si">%s</span><span class="s2"> from </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">file_stac</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
                <span class="n">status</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">timeout</span><span class="p">,</span>
                <span class="n">DOWNLOAD_FILE_TIMEOUT</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="c1"># remove all the well ingested files</span>
    <span class="c1"># return only those that failed</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">downloaded_files_indices</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">failed_files</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">failed_files</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rs_workflows.staging.staging_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">staging_flow</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Prefect flow for staging (downloading/ingesting) files from a station.</p>
<p>This flow orchestrates the download process by obtaining the list of files from the search endpoint (provided
station), splitting the list into tasks based on the number of workers, and submitting tasks for ingestion.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="rs_workflows.staging.PrefectFlowConfig" href="#rs_workflows.staging.PrefectFlowConfig">PrefectFlowConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object containing details about the download flow, such as
start and stop datetime, limit, rs_client, mission, temporary download path, S3 path, and max_workers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the flow execution is successful, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This function does not raise any exceptions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>docs/rs-client-libraries/rs_workflows/staging.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@flow</span><span class="p">(</span>
    <span class="n">flow_run_name</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{config.rs_client_serialization.get_flow_name}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">task_runner</span><span class="o">=</span><span class="n">DaskTaskRunner</span><span class="p">(</span><span class="n">cluster_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;n_workers&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;threads_per_worker&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">staging_flow</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">PrefectFlowConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prefect flow for staging (downloading/ingesting) files from a station.</span>

<span class="sd">    This flow orchestrates the download process by obtaining the list of files from the search endpoint (provided</span>
<span class="sd">    station), splitting the list into tasks based on the number of workers, and submitting tasks for ingestion.</span>

<span class="sd">    Args:</span>
<span class="sd">        config (PrefectFlowConfig): Configuration object containing details about the download flow, such as</span>
<span class="sd">            start and stop datetime, limit, rs_client, mission, temporary download path, S3 path, and max_workers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool (bool): True if the flow execution is successful, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        None: This function does not raise any exceptions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the Prefect logger</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_prefect_logger</span><span class="p">(</span><span class="s2">&quot;flow_dwn&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The staging flow is starting. Received workers:</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">max_workers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Deserialize the RsClient instance</span>
        <span class="n">rs_client</span><span class="p">:</span> <span class="n">AuxipClient</span> <span class="o">|</span> <span class="n">CadipClient</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">rs_client_serialization</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="c1"># get the list with files from the search endpoint</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">files_stac</span> <span class="o">=</span> <span class="n">rs_client</span><span class="o">.</span><span class="n">search_stations</span><span class="p">(</span>
                <span class="n">config</span><span class="o">.</span><span class="n">start_datetime</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">stop_datetime</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
                <span class="n">timeout</span><span class="o">=</span><span class="n">SEARCH_ENDPOINT_TIMEOUT</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unable to get the list with files for staging: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># check if the list with files returned from the station is not empty</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files_stac</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The station </span><span class="si">{</span><span class="n">rs_client</span><span class="o">.</span><span class="n">station_name</span><span class="si">}</span><span class="s2"> did not return any </span><span class="se">\</span>
<span class="s2">element for time interval </span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">start_datetime</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">stop_datetime</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="c1"># create the collection name</span>

        <span class="c1"># filter those that are already existing</span>

        <span class="n">files_stac</span> <span class="o">=</span> <span class="n">filter_unpublished_files</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
            <span class="n">rs_client</span><span class="o">.</span><span class="n">get_stac_client</span><span class="p">(),</span>  <span class="c1"># NOTE: maybe use RsClientSerialization instead</span>
            <span class="n">create_collection_name</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">mission</span><span class="p">,</span> <span class="n">rs_client</span><span class="o">.</span><span class="n">station_name</span><span class="p">),</span>
            <span class="n">files_stac</span><span class="p">,</span>
            <span class="n">wait_for</span><span class="o">=</span><span class="p">[</span><span class="n">files_stac</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="c1"># distribute the filenames evenly in a number of lists equal with</span>
        <span class="c1"># the minimum between number of runners and files to be downloaded</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tasks_files_stac</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">x</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">files_stac</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">max_workers</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">files_stac</span><span class="p">)))]</span>
            <span class="p">]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No task will be started, the requested number of tasks is 0 !&quot;</span><span class="p">)</span>
            <span class="n">tasks_files_stac</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;List with files to be downloaded (after filtering against the catalog)&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files_stac</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;      </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">files_stac</span> <span class="ow">in</span> <span class="n">tasks_files_stac</span><span class="p">:</span>
            <span class="n">staging</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span>
                <span class="n">PrefectTaskConfig</span><span class="p">(</span>
                    <span class="n">rs_client</span><span class="p">,</span>
                    <span class="n">config</span><span class="o">.</span><span class="n">mission</span><span class="p">,</span>
                    <span class="n">config</span><span class="o">.</span><span class="n">tmp_download_path</span><span class="p">,</span>
                    <span class="n">config</span><span class="o">.</span><span class="n">s3_path</span><span class="p">,</span>
                    <span class="n">files_stac</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="p">(</span><span class="ne">RuntimeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Exception caught: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="rs_workflows.staging.update_stac_catalog" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_stac_catalog</span><span class="p">(</span><span class="n">stac_client</span><span class="p">,</span> <span class="n">collection_name</span><span class="p">,</span> <span class="n">stac_file_info</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Update the STAC catalog with file information.</p>
<p>This task updates the STAC catalog with the information of a file that has been processed
and saved to a specific location. It adds the mandatory fields such as geometry, collection name and object storage
href. It sends a POST request to add the newly composed item into the STAC catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>stac_client</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="rs_client.stac_client.StacClient" href="../rs_client/#rs_client.stac_client.StacClient">StacClient</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The client for accessing the STAC catalog.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>collection_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the collection in the STAC catalog.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>stac_file_info</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Information about the STAC file to be updated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>obs</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The bucket location where the file has been saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the STAC catalog is successfully updated, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>docs/rs-client-libraries/rs_workflows/staging.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">update_stac_catalog</span><span class="p">(</span>  <span class="c1"># pylint: disable=too-many-locals</span>
    <span class="n">stac_client</span><span class="p">:</span> <span class="n">StacClient</span><span class="p">,</span>  <span class="c1"># NOTE: maybe use RsClientSerialization instead</span>
    <span class="n">collection_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">stac_file_info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">obs</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the STAC catalog with file information.</span>

<span class="sd">    This task updates the STAC catalog with the information of a file that has been processed</span>
<span class="sd">    and saved to a specific location. It adds the mandatory fields such as geometry, collection name and object storage</span>
<span class="sd">    href. It sends a POST request to add the newly composed item into the STAC catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        stac_client (StacClient): The client for accessing the STAC catalog.</span>
<span class="sd">        collection_name (str): The name of the collection in the STAC catalog.</span>
<span class="sd">        stac_file_info (dict): Information about the STAC file to be updated.</span>
<span class="sd">        obs (str): The bucket location where the file has been saved.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool (bool): True if the STAC catalog is successfully updated, False otherwise.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">item_id</span> <span class="o">=</span> <span class="n">stac_file_info</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

    <span class="c1"># The file path from the temp s3 bucket is given in the assets</span>
    <span class="n">assets</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">Asset</span><span class="p">(</span><span class="n">href</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obs</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">stac_file_info</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)}</span>

    <span class="c1"># Copy properties from the input stac file, or use default values</span>
    <span class="n">properties</span> <span class="o">=</span> <span class="n">stac_file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;properties&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="n">geometry</span> <span class="o">=</span> <span class="n">stac_file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{</span>  <span class="c1"># NOTE: override the geometry if it is set to None</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
        <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[[[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">]]],</span>
    <span class="p">}</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="n">stac_file_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bbox&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">[</span><span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">]</span>
    <span class="n">datetime_value</span> <span class="o">=</span> <span class="n">now</span>

    <span class="c1"># Try to format each property date or datetime</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateutil</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">DATETIME_FORMAT_MS</span><span class="p">)</span>
        <span class="c1"># If this is not a datetime, do nothing</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">dateutil</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">ParserError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">pass</span>

    <span class="c1"># Add item to the STAC catalog collection, check status is OK</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">item_id</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span> <span class="n">datetime</span><span class="o">=</span><span class="n">datetime_value</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="n">properties</span><span class="p">,</span> <span class="n">assets</span><span class="o">=</span><span class="n">assets</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">stac_client</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">collection_name</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">CATALOG_REQUEST_TIMEOUT</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">,</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">Timeout</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">stac_client</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Request exception caught: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="n">stac_client</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The catalog update endpoint: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
        <span class="n">stac_client</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not get the json body from response: </span><span class="si">{</span><span class="n">response</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024, ESA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "navigation.tracking", "navigation.indexes", "navigation.path", "toc.integrate", "toc.follow", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>